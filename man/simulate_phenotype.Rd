% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_linreg.R
\name{simulate_phenotype}
\alias{simulate_phenotype}
\title{Simulate Phenotype with Controllable Per-SNP Heritability}
\usage{
simulate_phenotype(X, n_causal = 5, h2_per_snp = 0.01, independent = TRUE)
}
\arguments{
\item{X}{Standardized genotype matrix (individuals x SNPs).}

\item{n_causal}{Number of causal variants.}

\item{h2_per_snp}{Desired heritability per causal SNP (e.g., 0.01).}

\item{independent}{Logical; if TRUE, causal SNPs are chosen to be approximately independent (low LD).}
}
\value{
A list containing:
  \item{G}{The input genotype matrix.}
  \item{y}{Phenotype vector.}
  \item{beta}{Vector of true effect sizes.}
  \item{causal}{Indices of causal variants.}
  \item{h2_total}{Total heritability (h2_per_snp * n_causal).}
  \item{h2_per_snp}{Per-SNP heritability used.}
  \item{residual_variance}{Residual variance of the phenotype.}
}
\description{
Simulates a phenotype based on genotype data with specified per-SNP heritability.
Causal variants can be constrained to be approximately independent (low LD).
}
\examples{
G <- matrix(rbinom(1000, 2, 0.5), nrow = 100, ncol = 10)
G <- scale(G)
result <- simulate_phenotype(G, n_causal = 3, h2_per_snp = 0.05)
}
